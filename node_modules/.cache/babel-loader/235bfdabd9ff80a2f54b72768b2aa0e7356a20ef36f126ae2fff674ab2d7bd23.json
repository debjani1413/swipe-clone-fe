{"ast":null,"code":"var _s = $RefreshSig$();\n// import {useState} from 'react';\n// import Papa from \"papaparse\";\n// import { read, utils } from \"xlsx\";\n// import { useDispatch } from \"react-redux\";\n// import { setUploadMessage } from \"../redux/uploadSlice\";\n// import { useSendFile } from \"./useSendFile\"; // Reuse the `useSendFile` hook\n\n// export const useFileChange = () => {\n//   const dispatch = useDispatch();\n//   const sendFile = useSendFile(); // Use the sendFile logic\n\n//   const [csvData, setCsvData] = useState(\"\");\n\n//   const convertFile = (event) => {\n//     const file = event.target.files[0];\n//     const reader = new FileReader();\n//     reader.onload = (e) => {\n//       const data = new Uint8Array(e.target.result);\n//       const workbook = read(data, { type: \"array\" });\n//       const sheetName = workbook.SheetNames[0];\n//       const sheet = workbook.Sheets[sheetName];\n//       const csvData = Papa.unparse(utils.sheet_to_json(sheet), {\n//         header: false,\n//       });\n//       const newHeader = \"Register No, Student Name, Branch, Semester, Course, Exam Type, Attendance, Withheld, IMark, Grade, Result\\n\";\n//       const finalCSVData= newHeader + csvData.substring(csvData.indexOf(\"\\n\") + 1)\n//       setCsvData(finalCSVData);\n//     };\n//     reader.readAsArrayBuffer(file);\n//   };\n\n//   const handleFileChange = (event) => {\n//     const file = event.target.files[0];\n//     if (file) {\n//       console.log(\"File selected:\", file);\n\n//       if(file.type === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\")\n//       {convertFile(file); sendFile(csvData)}\n//       else\n//       // Call the sendFile function from the hook\n//       sendFile(file);\n\n//       // Simulate a delay for setting the upload message\n//       setTimeout(() => {\n//         dispatch(setUploadMessage(`File \"${file.name}\" uploaded successfully!`));\n//       }, 1000);\n//     }\n//   };\n\n//   return handleFileChange; // Return the handler function\n// };\n\nimport { useState } from 'react';\nimport Papa from \"papaparse\";\nimport { read, utils } from \"xlsx\";\nimport { useDispatch } from \"react-redux\";\nimport { setUploadMessage } from \"../redux/uploadSlice\";\nimport { useSendFile } from \"./useSendFile\"; // Reuse the `useSendFile` hook\n\nexport const useFileChange = () => {\n  _s();\n  const dispatch = useDispatch();\n  const sendFile = useSendFile(); // Use the sendFile logic\n\n  const [csvData, setCsvData] = useState(\"\");\n  const convertFile = file => {\n    const reader = new FileReader();\n    reader.onload = e => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = read(data, {\n        type: \"array\"\n      });\n      const sheetName = workbook.SheetNames[0];\n      const sheet = workbook.Sheets[sheetName];\n      const csvData = Papa.unparse(utils.sheet_to_json(sheet), {\n        header: false\n      });\n      const newHeader = \"Register No, Student Name, Branch, Semester, Course, Exam Type, Attendance, Withheld, IMark, Grade, Result\\n\";\n      const finalCSVData = newHeader + csvData.substring(csvData.indexOf(\"\\n\") + 1);\n      setCsvData(finalCSVData);\n      // After updating csvData, send the file\n      sendFile(finalCSVData);\n    };\n    reader.readAsArrayBuffer(file);\n  };\n  const handleFileChange = event => {\n    const file = event.target.files[0];\n    if (file) {\n      console.log(\"File selected:\", file);\n      if (file.type === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\") {\n        convertFile(file);\n      } else {\n        // For non-XLXS files, just send the file\n        sendFile(file);\n      }\n\n      // Simulate a delay for setting the upload message\n      setTimeout(() => {\n        dispatch(setUploadMessage(`File \"${file.name}\" uploaded successfully!`));\n      }, 1000);\n    }\n  };\n  return handleFileChange; // Return the handler function\n};\n_s(useFileChange, \"6Ih+4hzmG//d2Sk5ZudorxpiYuw=\", false, function () {\n  return [useDispatch, useSendFile];\n});","map":{"version":3,"names":["useState","Papa","read","utils","useDispatch","setUploadMessage","useSendFile","useFileChange","_s","dispatch","sendFile","csvData","setCsvData","convertFile","file","reader","FileReader","onload","e","data","Uint8Array","target","result","workbook","type","sheetName","SheetNames","sheet","Sheets","unparse","sheet_to_json","header","newHeader","finalCSVData","substring","indexOf","readAsArrayBuffer","handleFileChange","event","files","console","log","setTimeout","name"],"sources":["/Users/debjani1413/swipe-clone/frontend/src/hooks/useFileChange.js"],"sourcesContent":["// import {useState} from 'react';\n// import Papa from \"papaparse\";\n// import { read, utils } from \"xlsx\";\n// import { useDispatch } from \"react-redux\";\n// import { setUploadMessage } from \"../redux/uploadSlice\";\n// import { useSendFile } from \"./useSendFile\"; // Reuse the `useSendFile` hook\n\n// export const useFileChange = () => {\n//   const dispatch = useDispatch();\n//   const sendFile = useSendFile(); // Use the sendFile logic\n\n//   const [csvData, setCsvData] = useState(\"\");\n\n//   const convertFile = (event) => {\n//     const file = event.target.files[0];\n//     const reader = new FileReader();\n//     reader.onload = (e) => {\n//       const data = new Uint8Array(e.target.result);\n//       const workbook = read(data, { type: \"array\" });\n//       const sheetName = workbook.SheetNames[0];\n//       const sheet = workbook.Sheets[sheetName];\n//       const csvData = Papa.unparse(utils.sheet_to_json(sheet), {\n//         header: false,\n//       });\n//       const newHeader = \"Register No, Student Name, Branch, Semester, Course, Exam Type, Attendance, Withheld, IMark, Grade, Result\\n\";\n//       const finalCSVData= newHeader + csvData.substring(csvData.indexOf(\"\\n\") + 1)\n//       setCsvData(finalCSVData);\n//     };\n//     reader.readAsArrayBuffer(file);\n//   };\n\n\n//   const handleFileChange = (event) => {\n//     const file = event.target.files[0];\n//     if (file) {\n//       console.log(\"File selected:\", file);\n\n//       if(file.type === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\")\n//       {convertFile(file); sendFile(csvData)}\n//       else\n//       // Call the sendFile function from the hook\n//       sendFile(file);\n\n//       // Simulate a delay for setting the upload message\n//       setTimeout(() => {\n//         dispatch(setUploadMessage(`File \"${file.name}\" uploaded successfully!`));\n//       }, 1000);\n//     }\n//   };\n\n//   return handleFileChange; // Return the handler function\n// };\n\nimport { useState } from 'react';\nimport Papa from \"papaparse\";\nimport { read, utils } from \"xlsx\";\nimport { useDispatch } from \"react-redux\";\nimport { setUploadMessage } from \"../redux/uploadSlice\";\nimport { useSendFile } from \"./useSendFile\"; // Reuse the `useSendFile` hook\n\nexport const useFileChange = () => {\n  const dispatch = useDispatch();\n  const sendFile = useSendFile(); // Use the sendFile logic\n\n  const [csvData, setCsvData] = useState(\"\");\n\n  const convertFile = (file) => {\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = read(data, { type: \"array\" });\n      const sheetName = workbook.SheetNames[0];\n      const sheet = workbook.Sheets[sheetName];\n      const csvData = Papa.unparse(utils.sheet_to_json(sheet), {\n        header: false,\n      });\n      const newHeader = \"Register No, Student Name, Branch, Semester, Course, Exam Type, Attendance, Withheld, IMark, Grade, Result\\n\";\n      const finalCSVData = newHeader + csvData.substring(csvData.indexOf(\"\\n\") + 1);\n      \n      setCsvData(finalCSVData);\n      // After updating csvData, send the file\n      sendFile(finalCSVData);\n    };\n    reader.readAsArrayBuffer(file);\n  };\n\n  const handleFileChange = (event) => {\n    const file = event.target.files[0];\n    if (file) {\n      console.log(\"File selected:\", file);\n\n      if (file.type === \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\") {\n        convertFile(file);\n      } else {\n        // For non-XLXS files, just send the file\n        sendFile(file);\n      }\n\n      // Simulate a delay for setting the upload message\n      setTimeout(() => {\n        dispatch(setUploadMessage(`File \"${file.name}\" uploaded successfully!`));\n      }, 1000);\n    }\n  };\n\n  return handleFileChange; // Return the handler function\n};\n\n"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,SAASA,QAAQ,QAAQ,OAAO;AAChC,OAAOC,IAAI,MAAM,WAAW;AAC5B,SAASC,IAAI,EAAEC,KAAK,QAAQ,MAAM;AAClC,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,gBAAgB,QAAQ,sBAAsB;AACvD,SAASC,WAAW,QAAQ,eAAe,CAAC,CAAC;;AAE7C,OAAO,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACjC,MAAMC,QAAQ,GAAGL,WAAW,CAAC,CAAC;EAC9B,MAAMM,QAAQ,GAAGJ,WAAW,CAAC,CAAC,CAAC,CAAC;;EAEhC,MAAM,CAACK,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EAE1C,MAAMa,WAAW,GAAIC,IAAI,IAAK;IAC5B,MAAMC,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,MAAM,GAAIC,CAAC,IAAK;MACrB,MAAMC,IAAI,GAAG,IAAIC,UAAU,CAACF,CAAC,CAACG,MAAM,CAACC,MAAM,CAAC;MAC5C,MAAMC,QAAQ,GAAGrB,IAAI,CAACiB,IAAI,EAAE;QAAEK,IAAI,EAAE;MAAQ,CAAC,CAAC;MAC9C,MAAMC,SAAS,GAAGF,QAAQ,CAACG,UAAU,CAAC,CAAC,CAAC;MACxC,MAAMC,KAAK,GAAGJ,QAAQ,CAACK,MAAM,CAACH,SAAS,CAAC;MACxC,MAAMd,OAAO,GAAGV,IAAI,CAAC4B,OAAO,CAAC1B,KAAK,CAAC2B,aAAa,CAACH,KAAK,CAAC,EAAE;QACvDI,MAAM,EAAE;MACV,CAAC,CAAC;MACF,MAAMC,SAAS,GAAG,8GAA8G;MAChI,MAAMC,YAAY,GAAGD,SAAS,GAAGrB,OAAO,CAACuB,SAAS,CAACvB,OAAO,CAACwB,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;MAE7EvB,UAAU,CAACqB,YAAY,CAAC;MACxB;MACAvB,QAAQ,CAACuB,YAAY,CAAC;IACxB,CAAC;IACDlB,MAAM,CAACqB,iBAAiB,CAACtB,IAAI,CAAC;EAChC,CAAC;EAED,MAAMuB,gBAAgB,GAAIC,KAAK,IAAK;IAClC,MAAMxB,IAAI,GAAGwB,KAAK,CAACjB,MAAM,CAACkB,KAAK,CAAC,CAAC,CAAC;IAClC,IAAIzB,IAAI,EAAE;MACR0B,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAE3B,IAAI,CAAC;MAEnC,IAAIA,IAAI,CAACU,IAAI,KAAK,mEAAmE,EAAE;QACrFX,WAAW,CAACC,IAAI,CAAC;MACnB,CAAC,MAAM;QACL;QACAJ,QAAQ,CAACI,IAAI,CAAC;MAChB;;MAEA;MACA4B,UAAU,CAAC,MAAM;QACfjC,QAAQ,CAACJ,gBAAgB,CAAC,SAASS,IAAI,CAAC6B,IAAI,0BAA0B,CAAC,CAAC;MAC1E,CAAC,EAAE,IAAI,CAAC;IACV;EACF,CAAC;EAED,OAAON,gBAAgB,CAAC,CAAC;AAC3B,CAAC;AAAC7B,EAAA,CA9CWD,aAAa;EAAA,QACPH,WAAW,EACXE,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}